# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ Gemini –º–æ–¥–µ–ª–µ–π
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00 UTC (8:00 –ø–æ –ö–∏–µ–≤—É)
# –ò—Å—Ç–æ—á–Ω–∏–∫: GitHub Actions scheduled workflows

name: Update Gemini Models

on:
  schedule:
    # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00 UTC
    - cron: '0 6 * * *'
  
  # –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
  workflow_dispatch:

permissions:
  contents: write

jobs:
  update-models:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: pip install google-generativeai
      
      - name: Generate models list
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          CI: true  # –û—Ç–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞
        run: python list_models.py
      
      - name: Commit and push changes
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add gemini_models.html
          # –ö–æ–º–º–∏—Ç–∏–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
          git diff --staged --quiet || git commit -m "üîÑ Update models list $(date +'%Y-%m-%d %H:%M') UTC"
          git push
